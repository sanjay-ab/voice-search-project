Loading python/3.10.8-gpu
  Loading requirement: nvidia/nvhpc-nompi/22.2 gcc/10.2.0
    openmpi/4.1.6-cuda-11.6
Loading pytorch/1.13.1-gpu
  Loading requirement: nvidia/cudnn/8.6.0-cuda-11.6 nvidia/tensorrt/8.4.3.1-u2
    libsndfile/1.0.28
Training embeddings directory: data/tamil/embeddings/training_data/7/raw
Validation embeddings file: data/tamil/embeddings/validation_data/7/phonetized_3_9/all_embeddings_phonetized.pkl
START TIME: 2024-08-06_18:40:16
Training model for tamil with inputs from mHuBERT layer 7
Number of epochs: 3, patience: 2, learning rate: 0.0001
clip norm: 40, temperature: 0.15, num pairs per batch: 800
num batch pairs to accumulate gradients over: 1
time limit to create dataset: 600
temperature: 0.15
min phone seq length: 3, max phone seq length: 9
perturb sequences: False, max one sided perturb amount: 0.1

Model save directory: data/tamil/models/awe/7/initial_model_lr_0.0001_tmp_0.15_acc_1_bs_800_3_9

Loading embedded data from directory: data/tamil/embeddings/training_data/7/raw
Loaded embedded data from data/tamil/embeddings/training_data/7/raw
Time taken: 162.39 s
Dataset generation time limit reached: 600 s.
Number of classes remaining: 4.
Created paired data
Loading embedded data from file: data/tamil/embeddings/validation_data/7/phonetized_3_9/all_embeddings_phonetized.pkl
Loaded embedded data from data/tamil/embeddings/validation_data/7/phonetized_3_9/all_embeddings_phonetized.pkl
Time taken: 19.55 s
Created paired data
Time taken to create datasets: 820.36 s
/work/y07/shared/cirrus-software/pytorch/1.13.1-gpu/python/3.10.8/lib/python3.10/site-packages/torch/nn/modules/conv.py:459: UserWarning: Using padding='same' with even kernel lengths and odd dilation may require a zero-padded copy of the input be created (Triggered internally at ../aten/src/ATen/native/Convolution.cpp:895.)
  return F.conv2d(input, weight, bias, self.stride,
Epoch 0: 0.00% done
Loss: 83.7642306373233
Time: 22.18 s
Epoch 0: 10.00% done
Loss: 4.717073879743763
Time: 616.27 s
Epoch 0: 20.00% done
Loss: 1.465883806024061
Time: 1219.72 s
Epoch 0: 30.00% done
Loss: 1.3395987328560601
Time: 1817.33 s
Epoch 0: 40.00% done
Loss: 1.2347160299502826
Time: 2402.95 s
Epoch 0: 50.00% done
Loss: 1.1496731409077094
Time: 2984.04 s
Epoch 0: 60.00% done
Loss: 1.1655384168605574
Time: 3577.56 s
Epoch 0: 70.00% done
Loss: 1.176258413653308
Time: 4175.14 s
Epoch 0: 80.00% done
Loss: 1.1488262205389008
Time: 4775.30 s
Epoch 0: 90.00% done
Loss: 1.1162824493168295
Time: 5354.64 s

Epoch 0 done
Epoch loss: 1.5701958076671338

Time taken for epoch: 5939.08 s
Number of gradients clipped: 16

Calculating validation loss: 0.00% done
Time: 0.16 s
Calculating validation loss: 20.00% done
Time: 47.22 s
Calculating validation loss: 40.00% done
Time: 95.72 s
Calculating validation loss: 60.00% done
Time: 142.79 s
Calculating validation loss: 80.00% done
Time: 188.19 s

Validation loss: 31.8464004854156

Time taken: 234.61 s
Saving model to data/tamil/models/awe/7/initial_model_lr_0.0001_tmp_0.15_acc_1_bs_800_3_9/2024-08-06_18:40:16_checkpoint_epoch_0.pt

Dataset generation time limit reached: 600 s.
Number of classes remaining: 4.
Regenerated paired data
Epoch 1: 0.00% done
Loss: 1.7706584599283006
Time: 0.06 s
Epoch 1: 10.00% done
Loss: 1.0664422466403627
Time: 601.37 s
Epoch 1: 20.00% done
Loss: 1.0414838609791568
Time: 1212.17 s
Epoch 1: 30.00% done
Loss: 1.0458918271210165
Time: 1828.46 s
Epoch 1: 40.00% done
Loss: 1.008036356385379
Time: 2445.85 s
Epoch 1: 50.00% done
Loss: 1.0355313519938636
Time: 3062.78 s
Epoch 1: 60.00% done
Loss: 1.0222945517911488
Time: 3690.01 s
Epoch 1: 70.00% done
Loss: 1.0358685956391647
Time: 4291.29 s
Epoch 1: 80.00% done
Loss: 1.0288723346548132
Time: 4906.02 s
Epoch 1: 90.00% done
Loss: 1.0343613991061085
Time: 5512.25 s

Epoch 1 done
Epoch loss: 1.0331089167181946

Time taken for epoch: 6106.95 s
Number of gradients clipped: 24

Calculating validation loss: 0.00% done
Time: 0.25 s
Calculating validation loss: 20.00% done
Time: 48.90 s
Calculating validation loss: 40.00% done
Time: 95.48 s
Calculating validation loss: 60.00% done
Time: 138.70 s
Calculating validation loss: 80.00% done
Time: 183.15 s

Validation loss: 28.893199204313873

Time taken: 232.09 s
Saving model to data/tamil/models/awe/7/initial_model_lr_0.0001_tmp_0.15_acc_1_bs_800_3_9/2024-08-06_18:40:16_checkpoint_epoch_1.pt

Dataset generation time limit reached: 600 s.
Number of classes remaining: 4.
Regenerated paired data
Epoch 2: 0.00% done
Loss: 0.4225176200270653
Time: 0.20 s
Epoch 2: 10.00% done
Loss: 1.060142091214195
Time: 597.99 s
Epoch 2: 20.00% done
Loss: 1.068968723460464
Time: 1217.69 s
Epoch 2: 30.00% done
Loss: 1.0394185271902963
Time: 1823.00 s
Epoch 2: 40.00% done
Loss: 1.0773869606986812
Time: 2436.68 s
Epoch 2: 50.00% done
Loss: 1.0464629052793846
Time: 3059.88 s
Epoch 2: 60.00% done
Loss: 1.0375318146617645
Time: 3674.34 s
Epoch 2: 70.00% done
Loss: 1.0348263538022424
Time: 4287.69 s
Epoch 2: 80.00% done
Loss: 1.0389164366424752
Time: 4879.42 s
Epoch 2: 90.00% done
Loss: 1.044955198296954
Time: 5477.66 s

Epoch 2 done
Epoch loss: 1.0475951546032873

Time taken for epoch: 6068.93 s
Number of gradients clipped: 42

Calculating validation loss: 0.00% done
Time: 0.13 s
Calculating validation loss: 20.00% done
Time: 48.11 s
Calculating validation loss: 40.00% done
Time: 92.96 s
Calculating validation loss: 60.00% done
Time: 142.31 s
Calculating validation loss: 80.00% done
Time: 189.70 s

Validation loss: 23.821798631148873

Time taken: 236.98 s
Saving model to data/tamil/models/awe/7/initial_model_lr_0.0001_tmp_0.15_acc_1_bs_800_3_9/2024-08-06_18:40:16_checkpoint_epoch_2.pt

Dataset generation time limit reached: 600 s.
Number of classes remaining: 4.
Regenerated paired data
BEST VALIDATION LOSS: 23.821798631148873 at epoch 2

