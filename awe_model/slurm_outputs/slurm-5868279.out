Loading python/3.10.8-gpu
  Loading requirement: nvidia/nvhpc-nompi/22.2 gcc/10.2.0
    openmpi/4.1.6-cuda-11.6
Loading pytorch/1.13.1-gpu
  Loading requirement: nvidia/cudnn/8.6.0-cuda-11.6 nvidia/tensorrt/8.4.3.1-u2
    libsndfile/1.0.28
Training embeddings directory: data/tamil/embeddings/training_data/9/raw
Validation embeddings file: data/tamil/embeddings/validation_data/9/phonetized_2_5/all_embeddings_phonetized.pkl
START TIME: 2024-08-07_15:55:35
Training model for tamil with inputs from mHuBERT layer 9
Number of epochs: 10, patience: 2, learning rate: 0.0001
clip norm: 40, temperature: 0.15, num pairs per batch: 800
num batch pairs to accumulate gradients over: 1
time limit to create dataset: 600
temperature: 0.15
min phone seq length: 2, max phone seq length: 5
perturb sequences: False, max one sided perturb amount: 0.1

Model save directory: data/tamil/models/awe/9/initial_model_lr_0.0001_tmp_0.15_acc_1_bs_800_2_5

Loading embedded data from directory: data/tamil/embeddings/training_data/9/raw
Loaded embedded data from data/tamil/embeddings/training_data/9/raw
Time taken: 151.34 s
Dataset generation time limit reached: 600 s.
Number of classes remaining: 151.
Created paired data
Loading embedded data from file: data/tamil/embeddings/validation_data/9/phonetized_2_5/all_embeddings_phonetized.pkl
Loaded embedded data from data/tamil/embeddings/validation_data/9/phonetized_2_5/all_embeddings_phonetized.pkl
Time taken: 15.79 s
Created paired data
Time taken to create datasets: 896.18 s
/work/y07/shared/cirrus-software/pytorch/1.13.1-gpu/python/3.10.8/lib/python3.10/site-packages/torch/nn/modules/conv.py:459: UserWarning: Using padding='same' with even kernel lengths and odd dilation may require a zero-padded copy of the input be created (Triggered internally at ../aten/src/ATen/native/Convolution.cpp:895.)
  return F.conv2d(input, weight, bias, self.stride,
Epoch 0: 0.00% done
Loss: 27.872131531497086
Time: 14.72 s
Epoch 0: 10.00% done
Loss: 5.894987894291565
Time: 471.96 s
Epoch 0: 20.00% done
Loss: 3.0488794130979007
Time: 934.37 s
Epoch 0: 30.00% done
Loss: 2.3798721361910116
Time: 1399.34 s
Epoch 0: 40.00% done
Loss: 2.124320418902494
Time: 1869.33 s
Epoch 0: 50.00% done
Loss: 1.9943611850009821
Time: 2329.03 s
Epoch 0: 60.00% done
Loss: 1.9084086764827584
Time: 2786.65 s
Epoch 0: 70.00% done
Loss: 1.8621898750110013
Time: 3249.95 s
Epoch 0: 80.00% done
Loss: 1.8207491241669618
Time: 3700.07 s
Epoch 0: 90.00% done
Loss: 1.7925677936001152
Time: 4155.12 s

Epoch 0 done
Epoch loss: 2.4604506519149747

Time taken for epoch: 4609.61 s
Number of gradients clipped: 0

Calculating validation loss: 0.00% done
Time: 0.55 s
Calculating validation loss: 20.00% done
Time: 150.75 s
Calculating validation loss: 40.00% done
Time: 308.88 s
Calculating validation loss: 60.00% done
Time: 460.95 s
Calculating validation loss: 80.00% done
Time: 617.74 s

Validation loss: 168.27853401347886

Time taken: 771.93 s
Saving model to data/tamil/models/awe/9/initial_model_lr_0.0001_tmp_0.15_acc_1_bs_800_2_5/2024-08-07_15:55:35_checkpoint_epoch_0.pt

Dataset generation time limit reached: 600 s.
Number of classes remaining: 166.
Regenerated paired data
Epoch 1: 0.00% done
Loss: 1.6950406021808258
Time: 1.28 s
Epoch 1: 10.00% done
Loss: 1.7410054000548139
Time: 446.19 s
Epoch 1: 20.00% done
Loss: 1.730075743435355
Time: 883.15 s
Epoch 1: 30.00% done
Loss: 1.719241578007168
Time: 1314.76 s
Epoch 1: 40.00% done
Loss: 1.7088585556328377
Time: 1747.46 s
Epoch 1: 50.00% done
Loss: 1.6953407982570252
Time: 2178.37 s
Epoch 1: 60.00% done
Loss: 1.6885117430345158
Time: 2611.68 s
Epoch 1: 70.00% done
Loss: 1.6777694702670245
Time: 3045.99 s
Epoch 1: 80.00% done
Loss: 1.6762167031293382
Time: 3480.39 s
Epoch 1: 90.00% done
Loss: 1.6645367742723973
Time: 3914.74 s

Epoch 1 done
Epoch loss: 1.6968240065620277

Time taken for epoch: 4347.71 s
Number of gradients clipped: 0

Calculating validation loss: 0.00% done
Time: 0.12 s
Calculating validation loss: 20.00% done
Time: 159.29 s
Calculating validation loss: 40.00% done
Time: 310.55 s
Calculating validation loss: 60.00% done
Time: 468.86 s
Calculating validation loss: 80.00% done
Time: 627.06 s

Validation loss: 143.2291029017777

Time taken: 788.05 s
Saving model to data/tamil/models/awe/9/initial_model_lr_0.0001_tmp_0.15_acc_1_bs_800_2_5/2024-08-07_15:55:35_checkpoint_epoch_1.pt

Dataset generation time limit reached: 600 s.
Number of classes remaining: 151.
Regenerated paired data
Epoch 2: 0.00% done
Loss: 1.6727534207430752
Time: 5.72 s
Epoch 2: 10.00% done
Loss: 1.6722280717010283
Time: 464.68 s
Epoch 2: 20.00% done
Loss: 1.6720579923686971
Time: 905.08 s
Epoch 2: 30.00% done
Loss: 1.6644590261861412
Time: 1375.64 s
Epoch 2: 40.00% done
Loss: 1.6556996574984375
Time: 1842.65 s
Epoch 2: 50.00% done
Loss: 1.6588806650759402
Time: 2298.99 s
Epoch 2: 60.00% done
Loss: 1.6479289108006732
Time: 2770.47 s
Epoch 2: 70.00% done
Loss: 1.6462098437504387
Time: 3234.26 s
Epoch 2: 80.00% done
Loss: 1.6431373749108198
Time: 3691.39 s
Epoch 2: 90.00% done
Loss: 1.6428900042123016
Time: 4141.22 s

Epoch 2 done
Epoch loss: 1.6539545381805971

Time taken for epoch: 4592.40 s
Number of gradients clipped: 0

Calculating validation loss: 0.00% done
Time: 0.22 s
Calculating validation loss: 20.00% done
Time: 154.94 s
Calculating validation loss: 40.00% done
Time: 311.96 s
Calculating validation loss: 60.00% done
Time: 469.91 s
Calculating validation loss: 80.00% done
Time: 624.69 s

Validation loss: 123.97798064897472

Time taken: 777.32 s
Saving model to data/tamil/models/awe/9/initial_model_lr_0.0001_tmp_0.15_acc_1_bs_800_2_5/2024-08-07_15:55:35_checkpoint_epoch_2.pt

Dataset generation time limit reached: 600 s.
Number of classes remaining: 154.
Regenerated paired data
Epoch 3: 0.00% done
Loss: 1.5853883463368075
Time: 0.72 s
Epoch 3: 10.00% done
Loss: 1.630227350487293
Time: 448.39 s
Epoch 3: 20.00% done
Loss: 1.6280769115895775
Time: 896.27 s
Epoch 3: 30.00% done
Loss: 1.625922543301661
Time: 1345.06 s
Epoch 3: 40.00% done
Loss: 1.6222222675802456
Time: 1776.06 s
Epoch 3: 50.00% done
Loss: 1.6177097284059343
Time: 2227.18 s
Epoch 3: 60.00% done
Loss: 1.617575585220434
Time: 2671.84 s
Epoch 3: 70.00% done
Loss: 1.6151617881784919
Time: 3121.60 s
Epoch 3: 80.00% done
Loss: 1.6110308566380207
Time: 3562.14 s
Epoch 3: 90.00% done
Loss: 1.6102722199172232
Time: 4040.83 s

Epoch 3 done
Epoch loss: 1.6188525605146842

Time taken for epoch: 4477.87 s
Number of gradients clipped: 1

Calculating validation loss: 0.00% done
Time: 0.48 s
Calculating validation loss: 20.00% done
Time: 153.41 s
Calculating validation loss: 40.00% done
Time: 303.29 s
Calculating validation loss: 60.00% done
Time: 459.33 s
Calculating validation loss: 80.00% done
Time: 613.53 s

Validation loss: 109.20993128723316

Time taken: 769.64 s
Saving model to data/tamil/models/awe/9/initial_model_lr_0.0001_tmp_0.15_acc_1_bs_800_2_5/2024-08-07_15:55:35_checkpoint_epoch_3.pt

Dataset generation time limit reached: 600 s.
Number of classes remaining: 156.
Regenerated paired data
Epoch 4: 0.00% done
Loss: 1.6582694053649902
Time: 0.09 s
Epoch 4: 10.00% done
Loss: 1.6046482951819463
Time: 445.99 s
Epoch 4: 20.00% done
Loss: 1.6032109475284946
Time: 888.50 s
Epoch 4: 30.00% done
Loss: 1.6071382806923042
Time: 1334.63 s
Epoch 4: 40.00% done
Loss: 1.5982524185410245
Time: 1797.67 s
Epoch 4: 50.00% done
Loss: 1.5993296400854442
Time: 2251.14 s
Epoch 4: 60.00% done
Loss: 1.5976130721619692
Time: 2697.78 s
Epoch 4: 70.00% done
Loss: 1.5989934981599303
Time: 3135.28 s
Epoch 4: 80.00% done
Loss: 1.5966694289604468
Time: 3566.30 s
Epoch 4: 90.00% done
Loss: 1.59730354654254
Time: 3999.41 s

Epoch 4 done
Epoch loss: 1.5996345058211696

Time taken for epoch: 4453.58 s
Number of gradients clipped: 1

Calculating validation loss: 0.00% done
Time: 0.17 s
Calculating validation loss: 20.00% done
Time: 152.88 s
Calculating validation loss: 40.00% done
Time: 303.89 s
Calculating validation loss: 60.00% done
Time: 455.89 s
Calculating validation loss: 80.00% done
Time: 609.31 s

Validation loss: 100.41495271728085

Time taken: 755.62 s
Saving model to data/tamil/models/awe/9/initial_model_lr_0.0001_tmp_0.15_acc_1_bs_800_2_5/2024-08-07_15:55:35_checkpoint_epoch_4.pt

Dataset generation time limit reached: 600 s.
Number of classes remaining: 156.
Regenerated paired data
Epoch 5: 0.00% done
Loss: 1.6504677859219639
Time: 0.20 s
Epoch 5: 10.00% done
Loss: 1.5976078659292643
Time: 442.97 s
Epoch 5: 20.00% done
Loss: 1.59027874035679
Time: 892.85 s
Epoch 5: 30.00% done
Loss: 1.592974585482752
Time: 1343.40 s
Epoch 5: 40.00% done
Loss: 1.5919442057726514
Time: 1779.99 s
Epoch 5: 50.00% done
Loss: 1.5898830815205383
Time: 2237.81 s
Epoch 5: 60.00% done
Loss: 1.5898805273986072
Time: 2680.41 s
Epoch 5: 70.00% done
Loss: 1.5873502519011953
Time: 3134.63 s
Epoch 5: 80.00% done
Loss: 1.586093757832919
Time: 3586.63 s
Epoch 5: 90.00% done
Loss: 1.5898456711264917
Time: 4030.15 s

Epoch 5 done
Epoch loss: 1.5901419370025287

Time taken for epoch: 4481.29 s
Number of gradients clipped: 0

Calculating validation loss: 0.00% done
Time: 0.53 s
Calculating validation loss: 20.00% done
Time: 148.06 s
Calculating validation loss: 40.00% done
Time: 298.85 s
Calculating validation loss: 60.00% done
Time: 450.91 s
Calculating validation loss: 80.00% done
Time: 606.00 s

Validation loss: 85.57103136599093

Time taken: 756.70 s
Saving model to data/tamil/models/awe/9/initial_model_lr_0.0001_tmp_0.15_acc_1_bs_800_2_5/2024-08-07_15:55:35_checkpoint_epoch_5.pt

Dataset generation time limit reached: 600 s.
Number of classes remaining: 145.
Regenerated paired data
Epoch 6: 0.00% done
Loss: 1.6477041998825506
Time: 0.10 s
Epoch 6: 10.00% done
Loss: 1.5946366739725177
Time: 458.66 s
Epoch 6: 20.00% done
Loss: 1.5966269598915124
Time: 914.16 s
Epoch 6: 30.00% done
Loss: 1.593728250353772
Time: 1384.23 s
Epoch 6: 40.00% done
Loss: 1.5907932829746116
Time: 1853.66 s
Epoch 6: 50.00% done
Loss: 1.5921728844375014
Time: 2324.99 s
Epoch 6: 60.00% done
Loss: 1.5900738227923392
Time: 2798.79 s
Epoch 6: 70.00% done
Loss: 1.5912843149687488
Time: 3258.67 s
Epoch 6: 80.00% done
Loss: 1.588949587401022
Time: 3717.81 s
Epoch 6: 90.00% done
Loss: 1.588695292283123
Time: 4186.61 s

Epoch 6 done
Epoch loss: 1.5913240050621755

Time taken for epoch: 4654.13 s
Number of gradients clipped: 0

Calculating validation loss: 0.00% done
Time: 0.15 s
Calculating validation loss: 20.00% done
Time: 149.40 s
Calculating validation loss: 40.00% done
Time: 290.79 s
Calculating validation loss: 60.00% done
Time: 437.91 s
Calculating validation loss: 80.00% done
Time: 590.24 s

Validation loss: 80.00258673624963

Time taken: 745.80 s
Saving model to data/tamil/models/awe/9/initial_model_lr_0.0001_tmp_0.15_acc_1_bs_800_2_5/2024-08-07_15:55:35_checkpoint_epoch_6.pt

Dataset generation time limit reached: 600 s.
Number of classes remaining: 145.
Regenerated paired data
Epoch 7: 0.00% done
Loss: 1.6663952238240818
Time: 3.09 s
Epoch 7: 10.00% done
Loss: 1.5938523922872758
Time: 471.53 s
Epoch 7: 20.00% done
Loss: 1.5886632633156414
Time: 936.02 s
Epoch 7: 30.00% done
Loss: 1.5932325810244639
Time: 1408.12 s
Epoch 7: 40.00% done
Loss: 1.5902907391970145
Time: 1868.21 s
Epoch 7: 50.00% done
Loss: 1.5913562995124693
Time: 2328.57 s
Epoch 7: 60.00% done
Loss: 1.5918648942611229
Time: 2784.62 s
Epoch 7: 70.00% done
Loss: 1.5914610662813025
Time: 3244.22 s
Epoch 7: 80.00% done
Loss: 1.5952964639652545
Time: 3716.00 s
Epoch 7: 90.00% done
Loss: 1.6043148412168764
Time: 4194.96 s

Epoch 7 done
Epoch loss: 1.594559769531364

Time taken for epoch: 4654.21 s
Number of gradients clipped: 1

Calculating validation loss: 0.00% done
Time: 0.47 s
Calculating validation loss: 20.00% done
Time: 144.86 s
Calculating validation loss: 40.00% done
Time: 289.93 s
Calculating validation loss: 60.00% done
Time: 441.39 s
Calculating validation loss: 80.00% done
Time: 589.31 s

Validation loss: 82.69566694488306

Time taken: 732.65 s
Saving model to data/tamil/models/awe/9/initial_model_lr_0.0001_tmp_0.15_acc_1_bs_800_2_5/2024-08-07_15:55:35_checkpoint_epoch_7.pt

Dataset generation time limit reached: 600 s.
Number of classes remaining: 166.
Regenerated paired data
Epoch 8: 0.00% done
Loss: 1.6457236331442127
Time: 0.17 s
Epoch 8: 10.00% done
Loss: 1.583243832613019
Time: 411.14 s
Epoch 8: 20.00% done
Loss: 1.579737585179336
Time: 832.52 s
Epoch 8: 30.00% done
Loss: 1.5815757651700721
Time: 1233.27 s
Epoch 8: 40.00% done
Loss: 1.5771486337313199
Time: 1645.44 s
Epoch 8: 50.00% done
Loss: 1.5814672835212888
Time: 2055.08 s
Epoch 8: 60.00% done
Loss: 1.5747602567506127
Time: 2487.49 s
Epoch 8: 70.00% done
Loss: 1.5638622274011909
Time: 2930.04 s
Epoch 8: 80.00% done
Loss: 1.5712414247556783
Time: 3355.10 s
Epoch 8: 90.00% done
Loss: 1.568905499355673
Time: 3782.87 s

Epoch 8 done
Epoch loss: 1.5752603213388596

Time taken for epoch: 4208.64 s
Number of gradients clipped: 0

Calculating validation loss: 0.00% done
Time: 0.25 s
Calculating validation loss: 20.00% done
Time: 152.11 s
Calculating validation loss: 40.00% done
Time: 297.44 s
Calculating validation loss: 60.00% done
Time: 445.34 s
Calculating validation loss: 80.00% done
Time: 589.77 s

Validation loss: 80.00220775820081

Time taken: 734.37 s
Saving model to data/tamil/models/awe/9/initial_model_lr_0.0001_tmp_0.15_acc_1_bs_800_2_5/2024-08-07_15:55:35_checkpoint_epoch_8.pt

srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** JOB 5868279 ON r2i7n2 CANCELLED AT 2024-08-08T06:55:52 DUE TO TIME LIMIT ***
slurmstepd: error: *** STEP 5868279.0 ON r2i7n2 CANCELLED AT 2024-08-08T06:55:52 DUE TO TIME LIMIT ***
