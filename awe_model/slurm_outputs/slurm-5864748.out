Loading python/3.10.8-gpu
  Loading requirement: nvidia/nvhpc-nompi/22.2 gcc/10.2.0
    openmpi/4.1.6-cuda-11.6
Loading pytorch/1.13.1-gpu
  Loading requirement: nvidia/cudnn/8.6.0-cuda-11.6 nvidia/tensorrt/8.4.3.1-u2
    libsndfile/1.0.28
Training embeddings directory: data/tamil/embeddings/training_data/8/raw
Validation embeddings file: data/tamil/embeddings/validation_data/8/phonetized_3_9/all_embeddings_phonetized.pkl
START TIME: 2024-08-06_18:39:11
Training model for tamil with inputs from mHuBERT layer 8
Number of epochs: 3, patience: 2, learning rate: 0.0001
clip norm: 40, temperature: 0.15, num pairs per batch: 800
num batch pairs to accumulate gradients over: 1
time limit to create dataset: 600
temperature: 0.15
min phone seq length: 3, max phone seq length: 9
perturb sequences: False, max one sided perturb amount: 0.1

Model save directory: data/tamil/models/awe/8/initial_model_lr_0.0001_tmp_0.15_acc_1_bs_800_3_9

Loading embedded data from directory: data/tamil/embeddings/training_data/8/raw
Loaded embedded data from data/tamil/embeddings/training_data/8/raw
Time taken: 161.29 s
Dataset generation time limit reached: 600 s.
Number of classes remaining: 4.
Created paired data
Loading embedded data from file: data/tamil/embeddings/validation_data/8/phonetized_3_9/all_embeddings_phonetized.pkl
Loaded embedded data from data/tamil/embeddings/validation_data/8/phonetized_3_9/all_embeddings_phonetized.pkl
Time taken: 19.39 s
Created paired data
Time taken to create datasets: 818.66 s
/work/y07/shared/cirrus-software/pytorch/1.13.1-gpu/python/3.10.8/lib/python3.10/site-packages/torch/nn/modules/conv.py:459: UserWarning: Using padding='same' with even kernel lengths and odd dilation may require a zero-padded copy of the input be created (Triggered internally at ../aten/src/ATen/native/Convolution.cpp:895.)
  return F.conv2d(input, weight, bias, self.stride,
Epoch 0: 0.00% done
Loss: 250.70171356201172
Time: 8.67 s
Epoch 0: 10.00% done
Loss: 4.141981188690776
Time: 627.63 s
Epoch 0: 20.00% done
Loss: 1.2515277130099431
Time: 1242.94 s
Epoch 0: 30.00% done
Loss: 1.0648701994056269
Time: 1864.55 s
Epoch 0: 40.00% done
Loss: 1.0621327966997198
Time: 2504.33 s
Epoch 0: 50.00% done
Loss: 1.0086235096864842
Time: 3135.40 s
Epoch 0: 60.00% done
Loss: 0.9634999131094366
Time: 3753.24 s
Epoch 0: 70.00% done
Loss: 0.9498314625846459
Time: 4360.80 s
Epoch 0: 80.00% done
Loss: 0.9571301397847986
Time: 4971.28 s
Epoch 0: 90.00% done
Loss: 0.9603890997535515
Time: 5601.09 s

Epoch 0 done
Epoch loss: 1.3344787277751005

Time taken for epoch: 6227.98 s
Number of gradients clipped: 14

Calculating validation loss: 0.00% done
Time: 0.20 s
Calculating validation loss: 20.00% done
Time: 43.52 s
Calculating validation loss: 40.00% done
Time: 86.21 s
Calculating validation loss: 60.00% done
Time: 130.08 s
Calculating validation loss: 80.00% done
Time: 177.97 s

Validation loss: 29.083660075386273

Time taken: 227.94 s
Saving model to data/tamil/models/awe/8/initial_model_lr_0.0001_tmp_0.15_acc_1_bs_800_3_9/2024-08-06_18:39:11_checkpoint_epoch_0.pt

Dataset generation time limit reached: 600 s.
Number of classes remaining: 4.
Regenerated paired data
Epoch 1: 0.00% done
Loss: 0.8529501035809517
Time: 2.55 s
Epoch 1: 10.00% done
Loss: 1.1138399764264344
Time: 571.11 s
Epoch 1: 20.00% done
Loss: 1.1152948268746754
Time: 1153.97 s
Epoch 1: 30.00% done
Loss: 1.1103032013793563
Time: 1731.14 s
Epoch 1: 40.00% done
Loss: 1.1058486908243188
Time: 2315.34 s
Epoch 1: 50.00% done
Loss: 1.0960169553047405
Time: 2897.59 s
Epoch 1: 60.00% done
Loss: 1.113191076662261
Time: 3471.72 s
Epoch 1: 70.00% done
Loss: 1.1202970070301685
Time: 4047.95 s
Epoch 1: 80.00% done
Loss: 1.0900364146854316
Time: 4606.43 s
Epoch 1: 90.00% done
Loss: 1.0876100115786242
Time: 5180.04 s

Epoch 1 done
Epoch loss: 1.1047173294270918

Time taken for epoch: 5740.43 s
Number of gradients clipped: 21

Calculating validation loss: 0.00% done
Time: 0.01 s
Calculating validation loss: 20.00% done
Time: 44.03 s
Calculating validation loss: 40.00% done
Time: 93.72 s
Calculating validation loss: 60.00% done
Time: 142.48 s
Calculating validation loss: 80.00% done
Time: 192.19 s

Validation loss: 23.431997192074224

Time taken: 237.63 s
Saving model to data/tamil/models/awe/8/initial_model_lr_0.0001_tmp_0.15_acc_1_bs_800_3_9/2024-08-06_18:39:11_checkpoint_epoch_1.pt

Dataset generation time limit reached: 600 s.
Number of classes remaining: 4.
Regenerated paired data
Epoch 2: 0.00% done
Loss: 0.45115116983652115
Time: 0.03 s
Epoch 2: 10.00% done
Loss: 1.0782489561253978
Time: 563.69 s
Epoch 2: 20.00% done
Loss: 1.0832805061011044
Time: 1124.83 s
Epoch 2: 30.00% done
Loss: 1.0800368389343575
Time: 1693.84 s
Epoch 2: 40.00% done
Loss: 1.102073404586142
Time: 2286.88 s
Epoch 2: 50.00% done
Loss: 1.0962769101251428
Time: 2876.88 s
Epoch 2: 60.00% done
Loss: 1.0865838557939573
Time: 3476.53 s
Epoch 2: 70.00% done
Loss: 1.0877884944564253
Time: 4042.80 s
Epoch 2: 80.00% done
Loss: 1.0792115390631851
Time: 4631.97 s
Epoch 2: 90.00% done
Loss: 1.092177330847217
Time: 5214.65 s

Epoch 2 done
Epoch loss: 1.0860201418652646

Time taken for epoch: 5791.43 s
Number of gradients clipped: 32

Calculating validation loss: 0.00% done
Time: 0.15 s
Calculating validation loss: 20.00% done
Time: 47.24 s
Calculating validation loss: 40.00% done
Time: 89.55 s
Calculating validation loss: 60.00% done
Time: 134.46 s
Calculating validation loss: 80.00% done
Time: 177.08 s

Validation loss: 20.596463664168134

Time taken: 220.36 s
Saving model to data/tamil/models/awe/8/initial_model_lr_0.0001_tmp_0.15_acc_1_bs_800_3_9/2024-08-06_18:39:11_checkpoint_epoch_2.pt

Dataset generation time limit reached: 600 s.
Number of classes remaining: 5.
Regenerated paired data
BEST VALIDATION LOSS: 20.596463664168134 at epoch 2

