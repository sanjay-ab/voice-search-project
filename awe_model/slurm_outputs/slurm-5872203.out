Loading python/3.10.8-gpu
  Loading requirement: nvidia/nvhpc-nompi/22.2 gcc/10.2.0
    openmpi/4.1.6-cuda-11.6
Loading pytorch/1.13.1-gpu
  Loading requirement: nvidia/cudnn/8.6.0-cuda-11.6 nvidia/tensorrt/8.4.3.1-u2
    libsndfile/1.0.28
Training embeddings directory: data/tamil/embeddings/training_data/10/raw
Validation embeddings file: data/tamil/embeddings/validation_data/10/phonetized_3_9/all_embeddings_phonetized.pkl
START TIME: 2024-08-08_12:07:15
Training model for tamil with inputs from mHuBERT layer 10
Number of epochs: 10, patience: 2, learning rate: 0.0001
clip norm: 40, temperature: 0.15, num pairs per batch: 5
num batch pairs to accumulate gradients over: 1000
time limit to create dataset: 240
temperature: 0.15
min phone seq length: 3, max phone seq length: 9
perturb sequences: False, max one sided perturb amount: 0.1

Model save directory: data/tamil/models/awe/10/initial_model_lr_0.0001_tmp_0.15_acc_1000_bs_5_3_9

Loading embedded data from directory: data/tamil/embeddings/training_data/10/raw
Loaded embedded data from data/tamil/embeddings/training_data/10/raw
Time taken: 146.81 s
Dataset generation time limit reached: 240 s.
Number of classes remaining: 116.
Created paired data
Loading embedded data from file: data/tamil/embeddings/validation_data/10/phonetized_3_9/all_embeddings_phonetized.pkl
Loaded embedded data from data/tamil/embeddings/validation_data/10/phonetized_3_9/all_embeddings_phonetized.pkl
Time taken: 19.88 s
Created paired data
Time taken to create datasets: 447.38 s
/work/y07/shared/cirrus-software/pytorch/1.13.1-gpu/python/3.10.8/lib/python3.10/site-packages/torch/nn/modules/conv.py:459: UserWarning: Using padding='same' with even kernel lengths and odd dilation may require a zero-padded copy of the input be created (Triggered internally at ../aten/src/ATen/native/Convolution.cpp:895.)
  return F.conv2d(input, weight, bias, self.stride,
Epoch 0: 0.00% done
Loss: 339.23561096191406
Time: 12.24 s
Epoch 0: 10.00% done
Loss: 39.77119906419353
Time: 422.78 s
Epoch 0: 20.00% done
Loss: 16.434959521526856
Time: 823.25 s
Epoch 0: 30.00% done
Loss: 12.353150723032664
Time: 1225.47 s
Epoch 0: 40.00% done
Loss: 10.186041124699313
Time: 1635.82 s
Epoch 0: 50.00% done
Loss: 8.843313644346354
Time: 2055.11 s
Epoch 0: 60.00% done
Loss: 7.874781902932539
Time: 2484.88 s
Epoch 0: 70.00% done
Loss: 7.160436886642651
Time: 2902.54 s
Epoch 0: 80.00% done
Loss: 6.663916276070267
Time: 3322.20 s
Epoch 0: 90.00% done
Loss: 6.232665421680965
Time: 3736.67 s

Epoch 0 done
Epoch loss: 12.138161026879732

Time taken for epoch: 4148.81 s
Number of gradients clipped: 1283

Calculating validation loss: 0.00% done
Time: 0.03 s
Calculating validation loss: 20.00% done
Time: 54.55 s
Calculating validation loss: 40.00% done
Time: 109.33 s
Calculating validation loss: 60.00% done
Time: 164.23 s
Calculating validation loss: 80.00% done
Time: 218.46 s

Validation loss: 80.78682561150623

Time taken: 273.22 s
Saving model to data/tamil/models/awe/10/initial_model_lr_0.0001_tmp_0.15_acc_1000_bs_5_3_9/2024-08-08_12:07:15_checkpoint_epoch_0.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 130.
Regenerated paired data
Epoch 1: 0.00% done
Loss: 4.923453330993652
Time: 0.07 s
Epoch 1: 10.00% done
Loss: 5.69186362843126
Time: 383.54 s
Epoch 1: 20.00% done
Loss: 5.472560036233958
Time: 765.82 s
Epoch 1: 30.00% done
Loss: 5.191169444389714
Time: 1140.62 s
Epoch 1: 40.00% done
Loss: 5.12392356072174
Time: 1515.50 s
Epoch 1: 50.00% done
Loss: 4.877187524472603
Time: 1896.77 s
Epoch 1: 60.00% done
Loss: 4.7283974904915835
Time: 2281.28 s
Epoch 1: 70.00% done
Loss: 4.546186044327303
Time: 2670.18 s
Epoch 1: 80.00% done
Loss: 4.465826052840486
Time: 3058.46 s
Epoch 1: 90.00% done
Loss: 4.3051865785196375
Time: 3441.03 s

Epoch 1 done
Epoch loss: 4.863972288210821

Time taken for epoch: 3809.13 s
Number of gradients clipped: 4

Calculating validation loss: 0.00% done
Time: 0.12 s
Calculating validation loss: 20.00% done
Time: 55.26 s
Calculating validation loss: 40.00% done
Time: 112.03 s
Calculating validation loss: 60.00% done
Time: 167.48 s
Calculating validation loss: 80.00% done
Time: 221.60 s

Validation loss: 72.18294926846193

Time taken: 275.53 s
Saving model to data/tamil/models/awe/10/initial_model_lr_0.0001_tmp_0.15_acc_1000_bs_5_3_9/2024-08-08_12:07:15_checkpoint_epoch_1.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 101.
Regenerated paired data
Epoch 2: 0.00% done
Loss: 1.8124838173389435
Time: 0.06 s
Epoch 2: 10.00% done
Loss: 3.9539107288852473
Time: 396.99 s
Epoch 2: 20.00% done
Loss: 3.9021398878441413
Time: 794.97 s
Epoch 2: 30.00% done
Loss: 3.810350709005261
Time: 1194.47 s
Epoch 2: 40.00% done
Loss: 3.7323224073875467
Time: 1598.37 s
Epoch 2: 50.00% done
Loss: 3.6779262214718766
Time: 2014.67 s
Epoch 2: 60.00% done
Loss: 3.5579736524379113
Time: 2408.79 s
Epoch 2: 70.00% done
Loss: 3.5196094164721585
Time: 2803.41 s
Epoch 2: 80.00% done
Loss: 3.417056091054532
Time: 3201.59 s
Epoch 2: 90.00% done
Loss: 3.3674253367283575
Time: 3599.30 s

Epoch 2 done
Epoch loss: 3.625709526247976

Time taken for epoch: 3993.66 s
Number of gradients clipped: 4

Calculating validation loss: 0.00% done
Time: 0.01 s
Calculating validation loss: 20.00% done
Time: 51.14 s
Calculating validation loss: 40.00% done
Time: 103.25 s
Calculating validation loss: 60.00% done
Time: 155.30 s
Calculating validation loss: 80.00% done
Time: 205.67 s

Validation loss: 58.43888024443896

Time taken: 255.83 s
Saving model to data/tamil/models/awe/10/initial_model_lr_0.0001_tmp_0.15_acc_1000_bs_5_3_9/2024-08-08_12:07:15_checkpoint_epoch_2.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 116.
Regenerated paired data
Epoch 3: 0.00% done
Loss: 12.20010757446289
Time: 0.05 s
Epoch 3: 10.00% done
Loss: 3.3047711611491937
Time: 375.81 s
Epoch 3: 20.00% done
Loss: 3.299729394442507
Time: 744.17 s
Epoch 3: 30.00% done
Loss: 3.236910397249076
Time: 1111.15 s
Epoch 3: 40.00% done
Loss: 3.2164354456015185
Time: 1478.41 s
Epoch 3: 50.00% done
Loss: 3.180951963886246
Time: 1844.10 s
Epoch 3: 60.00% done
Loss: 3.1376582403219526
Time: 2213.59 s
Epoch 3: 70.00% done
Loss: 3.097088709359495
Time: 2584.72 s
Epoch 3: 80.00% done
Loss: 3.0748774358769078
Time: 2948.15 s
Epoch 3: 90.00% done
Loss: 3.0530695354630106
Time: 3314.15 s

Epoch 3 done
Epoch loss: 3.159462195927521

Time taken for epoch: 3684.21 s
Number of gradients clipped: 0

Calculating validation loss: 0.00% done
Time: 0.01 s
Calculating validation loss: 20.00% done
Time: 51.70 s
Calculating validation loss: 40.00% done
Time: 104.09 s
Calculating validation loss: 60.00% done
Time: 156.57 s
Calculating validation loss: 80.00% done
Time: 210.24 s

Validation loss: 51.17772180497213

Time taken: 262.90 s
Saving model to data/tamil/models/awe/10/initial_model_lr_0.0001_tmp_0.15_acc_1000_bs_5_3_9/2024-08-08_12:07:15_checkpoint_epoch_3.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 95.
Regenerated paired data
Epoch 4: 0.00% done
Loss: 4.241635203361511
Time: 7.94 s
Epoch 4: 10.00% done
Loss: 2.8916055578767907
Time: 426.72 s
Epoch 4: 20.00% done
Loss: 2.8308734949650844
Time: 850.13 s
Epoch 4: 30.00% done
Loss: 2.8197509891296195
Time: 1265.60 s
Epoch 4: 40.00% done
Loss: 2.7943691854884967
Time: 1675.67 s
Epoch 4: 50.00% done
Loss: 2.7481496780930144
Time: 2085.13 s
Epoch 4: 60.00% done
Loss: 2.746614382692434
Time: 2484.91 s
Epoch 4: 70.00% done
Loss: 2.7247233884936373
Time: 2892.01 s
Epoch 4: 80.00% done
Loss: 2.703805174602542
Time: 3297.96 s
Epoch 4: 90.00% done
Loss: 2.676377175611911
Time: 3714.64 s

Epoch 4 done
Epoch loss: 2.7606148673268476

Time taken for epoch: 4141.63 s
Number of gradients clipped: 2

Calculating validation loss: 0.00% done
Time: 0.08 s
Calculating validation loss: 20.00% done
Time: 53.15 s
Calculating validation loss: 40.00% done
Time: 105.61 s
Calculating validation loss: 60.00% done
Time: 158.98 s
Calculating validation loss: 80.00% done
Time: 212.79 s

Validation loss: 46.53110224819165

Time taken: 266.15 s
Saving model to data/tamil/models/awe/10/initial_model_lr_0.0001_tmp_0.15_acc_1000_bs_5_3_9/2024-08-08_12:07:15_checkpoint_epoch_4.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 107.
Regenerated paired data
Epoch 5: 0.00% done
Loss: 2.8250882029533386
Time: 0.06 s
Epoch 5: 10.00% done
Loss: 2.7196267104852145
Time: 387.34 s
Epoch 5: 20.00% done
Loss: 2.646475463132866
Time: 777.86 s
Epoch 5: 30.00% done
Loss: 2.651003218691978
Time: 1170.37 s
Epoch 5: 40.00% done
Loss: 2.658879065982419
Time: 1560.86 s
Epoch 5: 50.00% done
Loss: 2.610260974637131
Time: 1949.66 s
Epoch 5: 60.00% done
Loss: 2.6367970129545637
Time: 2344.62 s
Epoch 5: 70.00% done
Loss: 2.6091781108116416
Time: 2737.66 s
Epoch 5: 80.00% done
Loss: 2.57414053280757
Time: 3125.28 s
Epoch 5: 90.00% done
Loss: 2.554432801174698
Time: 3516.74 s

Epoch 5 done
Epoch loss: 2.623156846618362

Time taken for epoch: 3906.65 s
Number of gradients clipped: 0

Calculating validation loss: 0.00% done
Time: 0.19 s
Calculating validation loss: 20.00% done
Time: 51.91 s
Calculating validation loss: 40.00% done
Time: 104.87 s
Calculating validation loss: 60.00% done
Time: 156.88 s
Calculating validation loss: 80.00% done
Time: 210.42 s

Validation loss: 42.5980723719713

Time taken: 263.37 s
Saving model to data/tamil/models/awe/10/initial_model_lr_0.0001_tmp_0.15_acc_1000_bs_5_3_9/2024-08-08_12:07:15_checkpoint_epoch_5.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 102.
Regenerated paired data
Epoch 6: 0.00% done
Loss: 2.072622776031494
Time: 0.06 s
Epoch 6: 10.00% done
Loss: 2.5077126119242457
Time: 397.35 s
Epoch 6: 20.00% done
Loss: 2.505522483221637
Time: 797.28 s
Epoch 6: 30.00% done
Loss: 2.509605203693828
Time: 1192.40 s
Epoch 6: 40.00% done
Loss: 2.4898260747703698
Time: 1588.70 s
Epoch 6: 50.00% done
Loss: 2.4882112022544742
Time: 1989.96 s
Epoch 6: 60.00% done
Loss: 2.4736463779475915
Time: 2386.19 s
Epoch 6: 70.00% done
Loss: 2.4715853819476714
Time: 2787.90 s
Epoch 6: 80.00% done
Loss: 2.4735685498373075
Time: 3187.16 s
Epoch 6: 90.00% done
Loss: 2.418059744953699
Time: 3584.28 s

Epoch 6 done
Epoch loss: 2.4756500919384656

Time taken for epoch: 3980.03 s
Number of gradients clipped: 1

Calculating validation loss: 0.00% done
Time: 0.10 s
Calculating validation loss: 20.00% done
Time: 54.05 s
Calculating validation loss: 40.00% done
Time: 108.05 s
Calculating validation loss: 60.00% done
Time: 161.55 s
Calculating validation loss: 80.00% done
Time: 215.66 s

Validation loss: 40.02278240710237

Time taken: 269.57 s
Saving model to data/tamil/models/awe/10/initial_model_lr_0.0001_tmp_0.15_acc_1000_bs_5_3_9/2024-08-08_12:07:15_checkpoint_epoch_6.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 101.
Regenerated paired data
Epoch 7: 0.00% done
Loss: 1.5543727576732635
Time: 0.05 s
Epoch 7: 10.00% done
Loss: 2.3947172963875083
Time: 397.31 s
Epoch 7: 20.00% done
Loss: 2.408414246626178
Time: 793.15 s
Epoch 7: 30.00% done
Loss: 2.4060233874681916
Time: 1200.89 s
Epoch 7: 40.00% done
Loss: 2.417173792994234
Time: 1599.16 s
Epoch 7: 50.00% done
Loss: 2.3783463582121565
Time: 1995.76 s
Epoch 7: 60.00% done
Loss: 2.362769794049085
Time: 2393.45 s
Epoch 7: 70.00% done
Loss: 2.376469956804706
Time: 2790.51 s
Epoch 7: 80.00% done
Loss: 2.345703660051545
Time: 3190.23 s
Epoch 7: 90.00% done
Loss: 2.339312065333121
Time: 3584.78 s

Epoch 7 done
Epoch loss: 2.377605771285055

Time taken for epoch: 3981.20 s
Number of gradients clipped: 0

Calculating validation loss: 0.00% done
Time: 0.20 s
Calculating validation loss: 20.00% done
Time: 52.42 s
Calculating validation loss: 40.00% done
Time: 104.36 s
Calculating validation loss: 60.00% done
Time: 156.41 s
Calculating validation loss: 80.00% done
Time: 207.92 s

Validation loss: 36.74257454144557

Time taken: 260.49 s
Saving model to data/tamil/models/awe/10/initial_model_lr_0.0001_tmp_0.15_acc_1000_bs_5_3_9/2024-08-08_12:07:15_checkpoint_epoch_7.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 101.
Regenerated paired data
Epoch 8: 0.00% done
Loss: 3.01217257976532
Time: 0.07 s
Epoch 8: 10.00% done
Loss: 2.3246676302487854
Time: 405.30 s
Epoch 8: 20.00% done
Loss: 2.3435917744266135
Time: 806.76 s
Epoch 8: 30.00% done
Loss: 2.3235841090773874
Time: 1208.01 s
Epoch 8: 40.00% done
Loss: 2.333717697430507
Time: 1612.60 s
Epoch 8: 50.00% done
Loss: 2.300154278872352
Time: 2011.74 s
Epoch 8: 60.00% done
Loss: 2.286263554933504
Time: 2411.25 s
Epoch 8: 70.00% done
Loss: 2.268886003164918
Time: 2811.28 s
Epoch 8: 80.00% done
Loss: 2.285501671769422
Time: 3211.65 s
Epoch 8: 90.00% done
Loss: 2.2663688224733973
Time: 3616.89 s

Epoch 8 done
Epoch loss: 2.2975931290531157

Time taken for epoch: 4016.83 s
Number of gradients clipped: 0

Calculating validation loss: 0.00% done
Time: 0.20 s
Calculating validation loss: 20.00% done
Time: 51.64 s
Calculating validation loss: 40.00% done
Time: 102.02 s
Calculating validation loss: 60.00% done
Time: 153.36 s
Calculating validation loss: 80.00% done
Time: 204.04 s

Validation loss: 35.75173103838353

Time taken: 257.09 s
Saving model to data/tamil/models/awe/10/initial_model_lr_0.0001_tmp_0.15_acc_1000_bs_5_3_9/2024-08-08_12:07:15_checkpoint_epoch_8.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 99.
Regenerated paired data
Epoch 9: 0.00% done
Loss: 1.6030414402484894
Time: 3.67 s
Epoch 9: 10.00% done
Loss: 2.22955925691538
Time: 417.18 s
Epoch 9: 20.00% done
Loss: 2.24634982606938
Time: 831.97 s
Epoch 9: 30.00% done
Loss: 2.255481164862751
Time: 1247.22 s
Epoch 9: 40.00% done
Loss: 2.222322186034899
Time: 1651.82 s
Epoch 9: 50.00% done
Loss: 2.2122425986788237
Time: 2056.29 s
Epoch 9: 60.00% done
Loss: 2.1899487576217265
Time: 2460.85 s
Epoch 9: 70.00% done
Loss: 2.19878501394206
Time: 2868.10 s
Epoch 9: 80.00% done
Loss: 2.211230079195128
Time: 3272.33 s
Epoch 9: 90.00% done
Loss: 2.2214975029807853
Time: 3680.84 s

Epoch 9 done
Epoch loss: 2.2191985630731725

Time taken for epoch: 4080.16 s
Number of gradients clipped: 1

Calculating validation loss: 0.00% done
Time: 0.25 s
Calculating validation loss: 20.00% done
Time: 48.84 s
Calculating validation loss: 40.00% done
Time: 97.56 s
Calculating validation loss: 60.00% done
Time: 147.04 s
Calculating validation loss: 80.00% done
Time: 196.31 s

Validation loss: 34.83067302309301

Time taken: 245.23 s
Saving model to data/tamil/models/awe/10/initial_model_lr_0.0001_tmp_0.15_acc_1000_bs_5_3_9/2024-08-08_12:07:15_checkpoint_epoch_9.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 105.
Regenerated paired data
BEST VALIDATION LOSS: 34.83067302309301 at epoch 9

