Loading python/3.10.8-gpu
  Loading requirement: nvidia/nvhpc-nompi/22.2 gcc/10.2.0
    openmpi/4.1.6-cuda-11.6
Loading pytorch/1.13.1-gpu
  Loading requirement: nvidia/cudnn/8.6.0-cuda-11.6 nvidia/tensorrt/8.4.3.1-u2
    libsndfile/1.0.28
/work/y07/shared/cirrus-software/pytorch/1.13.1-gpu/python/3.10.8/lib/python3.10/site-packages/torch/nn/modules/conv.py:459: UserWarning: Using padding='same' with even kernel lengths and odd dilation may require a zero-padded copy of the input be created (Triggered internally at ../aten/src/ATen/native/Convolution.cpp:895.)
  return F.conv2d(input, weight, bias, self.stride,
START TIME: 2024-07-08_19:35:20
Training model for tamil with inputs from mHuBERT layer 8
Number of epochs: 10, patience: 3, learning rate: 0.0001
clip norm: 4, temperature: 0.15, num pairs per batch: 300
time limit to create dataset: 240
Dataset generation time limit reached: 240 s.
Number of classes remaining: 286.
Time taken to create datasets: 405.37 s
Epoch 0: 0.01% done
Loss: 6.379518032073975
Time: 22.58 s
Epoch 0: 10.00% done
Loss: 3.51566755754941
Time: 220.01 s
Epoch 0: 20.01% done
Loss: 3.191020456014895
Time: 409.38 s
Epoch 0: 30.00% done
Loss: 2.976090486489972
Time: 591.91 s
Epoch 0: 40.00% done
Loss: 2.811724529648762
Time: 775.41 s
Epoch 0: 50.01% done
Loss: 2.6774790080626616
Time: 958.92 s
Epoch 0: 60.00% done
Loss: 2.56222284721098
Time: 1147.11 s
Epoch 0: 70.01% done
Loss: 2.463271180379145
Time: 1337.19 s
Epoch 0: 80.00% done
Loss: 2.3778812063522112
Time: 1529.66 s
Epoch 0: 90.00% done
Loss: 2.3019416840292246
Time: 1726.62 s

Epoch 0 done
Epoch loss: 2.2335256038843734

Time taken for epoch: 1921.45 s
Number of gradients clipped: 2185

Calculating validation loss: 0.00% done
Time: 0.90 s
Calculating validation loss: 20.00% done
Time: 140.90 s
Calculating validation loss: 40.00% done
Time: 276.68 s
Calculating validation loss: 60.00% done
Time: 416.50 s
Calculating validation loss: 80.00% done
Time: 569.95 s

Validation loss: 1.2088858666655726

Time taken: 714.62 s
Saving model to data/tamil/models/8/2024-07-08_19:35:20_checkpoint_epoch_0.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 248.
Epoch 1: 0.01% done
Loss: 1.5635143518447876
Time: 0.53 s
Epoch 1: 10.01% done
Loss: 1.5388732536362026
Time: 215.99 s
Epoch 1: 20.00% done
Loss: 1.512238746686377
Time: 441.74 s
Epoch 1: 30.00% done
Loss: 1.4808017114602905
Time: 666.83 s
Epoch 1: 40.00% done
Loss: 1.4524816676167818
Time: 898.87 s
Epoch 1: 50.00% done
Loss: 1.428980893869904
Time: 1125.35 s
Epoch 1: 60.00% done
Loss: 1.4078087667227612
Time: 1345.45 s
Epoch 1: 70.00% done
Loss: 1.3877637775213947
Time: 1562.32 s
Epoch 1: 80.00% done
Loss: 1.3697276548969737
Time: 1779.33 s
Epoch 1: 90.00% done
Loss: 1.3517979485518532
Time: 2001.51 s

Epoch 1 done
Epoch loss: 1.3342042930723537

Time taken for epoch: 2230.08 s
Number of gradients clipped: 6052

Calculating validation loss: 0.00% done
Time: 0.06 s
Calculating validation loss: 20.00% done
Time: 147.78 s
Calculating validation loss: 40.00% done
Time: 293.84 s
Calculating validation loss: 60.00% done
Time: 440.90 s
Calculating validation loss: 80.00% done
Time: 588.92 s

Validation loss: 1.1700268821690534

Time taken: 735.79 s
Saving model to data/tamil/models/8/2024-07-08_19:35:20_checkpoint_epoch_1.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 280.
Epoch 2: 0.01% done
Loss: 1.0552937984466553
Time: 5.54 s
Epoch 2: 10.00% done
Loss: 1.1983721042447948
Time: 202.89 s
Epoch 2: 20.00% done
Loss: 1.183130868566216
Time: 399.71 s
Epoch 2: 30.01% done
Loss: 1.1772935249432614
Time: 599.85 s
Epoch 2: 40.00% done
Loss: 1.1686078310115038
Time: 800.54 s
Epoch 2: 50.00% done
Loss: 1.1606319163999925
Time: 997.43 s
Epoch 2: 60.01% done
Loss: 1.1513832160046513
Time: 1194.80 s
Epoch 2: 70.00% done
Loss: 1.1438299736430813
Time: 1393.26 s
Epoch 2: 80.00% done
Loss: 1.137494423273517
Time: 1592.81 s
Epoch 2: 90.00% done
Loss: 1.1322658184052603
Time: 1788.80 s

Epoch 2 done
Epoch loss: 1.12574767548745

Time taken for epoch: 1982.53 s
Number of gradients clipped: 3284

Calculating validation loss: 0.00% done
Time: 0.03 s
Calculating validation loss: 20.00% done
Time: 159.99 s
Calculating validation loss: 40.00% done
Time: 317.16 s
Calculating validation loss: 60.00% done
Time: 475.70 s
Calculating validation loss: 80.00% done
Time: 633.10 s

Validation loss: 1.134869661051756

Time taken: 794.22 s
Saving model to data/tamil/models/8/2024-07-08_19:35:20_checkpoint_epoch_2.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 264.
Epoch 3: 0.01% done
Loss: 0.9809411764144897
Time: 1.43 s
Epoch 3: 10.00% done
Loss: 1.0389259717974466
Time: 204.18 s
Epoch 3: 20.01% done
Loss: 1.040695615496832
Time: 411.98 s
Epoch 3: 30.00% done
Loss: 1.037056136528224
Time: 619.00 s
Epoch 3: 40.00% done
Loss: 1.0321004888910361
Time: 830.19 s
Epoch 3: 50.01% done
Loss: 1.0287334175281326
Time: 1036.30 s
Epoch 3: 60.00% done
Loss: 1.0262505490784999
Time: 1235.16 s
Epoch 3: 70.01% done
Loss: 1.0214027875180052
Time: 1446.30 s
Epoch 3: 80.00% done
Loss: 1.0182559153166073
Time: 1648.29 s
Epoch 3: 90.00% done
Loss: 1.0145547700619724
Time: 1846.38 s

Epoch 3 done
Epoch loss: 1.010606324893201

Time taken for epoch: 2060.67 s
Number of gradients clipped: 2937

Calculating validation loss: 0.00% done
Time: 0.02 s
Calculating validation loss: 20.00% done
Time: 154.62 s
Calculating validation loss: 40.00% done
Time: 297.77 s
Calculating validation loss: 60.00% done
Time: 442.59 s
Calculating validation loss: 80.00% done
Time: 589.20 s

Validation loss: 1.1288303229025018

Time taken: 736.31 s
Saving model to data/tamil/models/8/2024-07-08_19:35:20_checkpoint_epoch_3.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 260.
Epoch 4: 0.01% done
Loss: 0.7482619881629944
Time: 3.33 s
Epoch 4: 10.00% done
Loss: 0.9619145413988384
Time: 207.38 s
Epoch 4: 20.00% done
Loss: 0.9570643890596158
Time: 410.99 s
Epoch 4: 30.00% done
Loss: 0.9555381896173314
Time: 614.90 s
Epoch 4: 40.00% done
Loss: 0.9558304185260587
Time: 822.85 s
Epoch 4: 50.00% done
Loss: 0.9542635057206652
Time: 1032.40 s
Epoch 4: 60.00% done
Loss: 0.9505668889722731
Time: 1253.75 s
Epoch 4: 70.00% done
Loss: 0.9469663281469346
Time: 1462.82 s
Epoch 4: 80.00% done
Loss: 0.945300995309534
Time: 1668.16 s
Epoch 4: 90.01% done
Loss: 0.9428978128993154
Time: 1873.13 s

Epoch 4 done
Epoch loss: 0.9401877344232675

Time taken for epoch: 2076.63 s
Number of gradients clipped: 2718

Calculating validation loss: 0.00% done
Time: 0.21 s
Calculating validation loss: 20.00% done
Time: 135.94 s
Calculating validation loss: 40.00% done
Time: 282.42 s
Calculating validation loss: 60.00% done
Time: 427.39 s
Calculating validation loss: 80.00% done
Time: 568.37 s

Validation loss: 1.0894996992802137

Time taken: 727.69 s
Saving model to data/tamil/models/8/2024-07-08_19:35:20_checkpoint_epoch_4.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 260.
Epoch 5: 0.01% done
Loss: 0.8471486568450928
Time: 0.79 s
Epoch 5: 10.00% done
Loss: 0.9104954299166068
Time: 203.93 s
Epoch 5: 20.01% done
Loss: 0.9133228946183499
Time: 409.58 s
Epoch 5: 30.00% done
Loss: 0.9103401270355808
Time: 625.79 s
Epoch 5: 40.01% done
Loss: 0.908196617343976
Time: 845.82 s
Epoch 5: 50.00% done
Loss: 0.9056509267272793
Time: 1053.00 s
Epoch 5: 60.01% done
Loss: 0.9028358816397407
Time: 1270.39 s
Epoch 5: 70.00% done
Loss: 0.9007398083697656
Time: 1486.84 s
Epoch 5: 80.01% done
Loss: 0.9004258249497108
Time: 1704.39 s
Epoch 5: 90.00% done
Loss: 0.9005232423492529
Time: 1926.17 s

Epoch 5 done
Epoch loss: 0.8995072539753516

Time taken for epoch: 2147.09 s
Number of gradients clipped: 2473

Calculating validation loss: 0.00% done
Time: 0.02 s
Calculating validation loss: 20.00% done
Time: 155.69 s
Calculating validation loss: 40.00% done
Time: 314.63 s
Calculating validation loss: 60.00% done
Time: 460.47 s
Calculating validation loss: 80.00% done
Time: 606.98 s

Validation loss: 1.03579594881386

Time taken: 759.73 s
Saving model to data/tamil/models/8/2024-07-08_19:35:20_checkpoint_epoch_5.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 260.
Epoch 6: 0.01% done
Loss: 0.859453022480011
Time: 0.40 s
Epoch 6: 10.01% done
Loss: 0.8764436323031515
Time: 219.10 s
Epoch 6: 20.01% done
Loss: 0.8798656179201008
Time: 433.93 s
Epoch 6: 30.01% done
Loss: 0.8793816923650988
Time: 654.60 s
Epoch 6: 40.01% done
Loss: 0.8797472973655348
Time: 876.71 s
Epoch 6: 50.01% done
Loss: 0.878482377769014
Time: 1096.80 s
Epoch 6: 60.01% done
Loss: 0.8765083920719978
Time: 1312.84 s
Epoch 6: 70.01% done
Loss: 0.8753776258853703
Time: 1533.73 s
Epoch 6: 80.01% done
Loss: 0.8735957320881652
slurmstepd: error: *** JOB 5794445 ON r2i5n0 CANCELLED AT 2024-07-09T01:34:45 DUE TO TIME LIMIT ***
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** STEP 5794445.0 ON r2i5n0 CANCELLED AT 2024-07-09T01:34:45 DUE TO TIME LIMIT ***
