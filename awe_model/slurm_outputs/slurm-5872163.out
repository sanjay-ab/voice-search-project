Loading python/3.10.8-gpu
  Loading requirement: nvidia/nvhpc-nompi/22.2 gcc/10.2.0
    openmpi/4.1.6-cuda-11.6
Loading pytorch/1.13.1-gpu
  Loading requirement: nvidia/cudnn/8.6.0-cuda-11.6 nvidia/tensorrt/8.4.3.1-u2
    libsndfile/1.0.28
Training embeddings directory: data/tamil/embeddings/training_data/7/raw
Validation embeddings file: data/tamil/embeddings/validation_data/7/phonetized_3_9/all_embeddings_phonetized.pkl
START TIME: 2024-08-08_12:07:12
Training model for tamil with inputs from mHuBERT layer 7
Number of epochs: 10, patience: 2, learning rate: 0.0001
clip norm: 40, temperature: 0.15, num pairs per batch: 5
num batch pairs to accumulate gradients over: 1000
time limit to create dataset: 240
temperature: 0.15
min phone seq length: 3, max phone seq length: 9
perturb sequences: False, max one sided perturb amount: 0.1

Model save directory: data/tamil/models/awe/7/initial_model_lr_0.0001_tmp_0.15_acc_1000_bs_5_3_9

Loading embedded data from directory: data/tamil/embeddings/training_data/7/raw
Loaded embedded data from data/tamil/embeddings/training_data/7/raw
Time taken: 147.71 s
Dataset generation time limit reached: 240 s.
Number of classes remaining: 121.
Created paired data
Loading embedded data from file: data/tamil/embeddings/validation_data/7/phonetized_3_9/all_embeddings_phonetized.pkl
Loaded embedded data from data/tamil/embeddings/validation_data/7/phonetized_3_9/all_embeddings_phonetized.pkl
Time taken: 19.40 s
Created paired data
Time taken to create datasets: 449.51 s
/work/y07/shared/cirrus-software/pytorch/1.13.1-gpu/python/3.10.8/lib/python3.10/site-packages/torch/nn/modules/conv.py:459: UserWarning: Using padding='same' with even kernel lengths and odd dilation may require a zero-padded copy of the input be created (Triggered internally at ../aten/src/ATen/native/Convolution.cpp:895.)
  return F.conv2d(input, weight, bias, self.stride,
Epoch 0: 0.00% done
Loss: 346.97837829589844
Time: 2.09 s
Epoch 0: 10.00% done
Loss: 39.083667178354254
Time: 362.99 s
Epoch 0: 20.00% done
Loss: 16.075345835308006
Time: 721.40 s
Epoch 0: 30.00% done
Loss: 11.985693969528324
Time: 1080.24 s
Epoch 0: 40.00% done
Loss: 9.74438628560854
Time: 1441.94 s
Epoch 0: 50.00% done
Loss: 8.526581328191098
Time: 1816.77 s
Epoch 0: 60.00% done
Loss: 7.720696191866021
Time: 2196.03 s
Epoch 0: 70.00% done
Loss: 7.039057480005668
Time: 2580.84 s
Epoch 0: 80.00% done
Loss: 6.559201326789135
Time: 2969.30 s
Epoch 0: 90.00% done
Loss: 6.1082132254674635
Time: 3357.19 s

Epoch 0 done
Epoch loss: 11.853555911859608

Time taken for epoch: 3754.62 s
Number of gradients clipped: 1000

Calculating validation loss: 0.00% done
Time: 0.03 s
Calculating validation loss: 20.00% done
Time: 55.56 s
Calculating validation loss: 40.00% done
Time: 110.67 s
Calculating validation loss: 60.00% done
Time: 164.93 s
Calculating validation loss: 80.00% done
Time: 218.57 s

Validation loss: 73.18171237720334

Time taken: 272.05 s
Saving model to data/tamil/models/awe/7/initial_model_lr_0.0001_tmp_0.15_acc_1000_bs_5_3_9/2024-08-08_12:07:12_checkpoint_epoch_0.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 122.
Regenerated paired data
Epoch 1: 0.00% done
Loss: 2.474742829799652
Time: 0.06 s
Epoch 1: 10.00% done
Loss: 5.377477238165796
Time: 414.68 s
Epoch 1: 20.00% done
Loss: 5.180926948849363
Time: 819.01 s
Epoch 1: 30.00% done
Loss: 4.9607710549217545
Time: 1211.34 s
Epoch 1: 40.00% done
Loss: 4.801891768993383
Time: 1615.68 s
Epoch 1: 50.00% done
Loss: 4.552511428712647
Time: 2018.30 s
Epoch 1: 60.00% done
Loss: 4.383017436264046
Time: 2419.68 s
Epoch 1: 70.00% done
Loss: 4.3383245812008004
Time: 2796.66 s
Epoch 1: 80.00% done
Loss: 4.156349690364216
Time: 3169.64 s
Epoch 1: 90.00% done
Loss: 4.052039059455382
Time: 3546.72 s

Epoch 1 done
Epoch loss: 4.5747419611783195

Time taken for epoch: 3930.72 s
Number of gradients clipped: 2

Calculating validation loss: 0.00% done
Time: 0.02 s
Calculating validation loss: 20.00% done
Time: 54.26 s
Calculating validation loss: 40.00% done
Time: 107.43 s
Calculating validation loss: 60.00% done
Time: 159.23 s
Calculating validation loss: 80.00% done
Time: 211.65 s

Validation loss: 59.558739536152544

Time taken: 264.56 s
Saving model to data/tamil/models/awe/7/initial_model_lr_0.0001_tmp_0.15_acc_1000_bs_5_3_9/2024-08-08_12:07:12_checkpoint_epoch_1.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 116.
Regenerated paired data
Epoch 2: 0.00% done
Loss: 1.9836381077766418
Time: 0.06 s
Epoch 2: 10.00% done
Loss: 3.7347292833852137
Time: 413.44 s
Epoch 2: 20.00% done
Loss: 3.6996782120274836
Time: 839.78 s
Epoch 2: 30.00% done
Loss: 3.5857077575270266
Time: 1261.68 s
Epoch 2: 40.00% done
Loss: 3.518475371045192
Time: 1673.48 s
Epoch 2: 50.00% done
Loss: 3.468330358007897
Time: 2080.21 s
Epoch 2: 60.00% done
Loss: 3.3830625940725767
Time: 2481.69 s
Epoch 2: 70.00% done
Loss: 3.3479336360897247
Time: 2883.09 s
Epoch 2: 80.00% done
Loss: 3.255367247032192
Time: 3288.91 s
Epoch 2: 90.00% done
Loss: 3.250626578668012
Time: 3693.62 s

Epoch 2 done
Epoch loss: 3.440356137167087

Time taken for epoch: 4109.26 s
Number of gradients clipped: 2

Calculating validation loss: 0.00% done
Time: 0.16 s
Calculating validation loss: 20.00% done
Time: 55.07 s
Calculating validation loss: 40.00% done
Time: 110.72 s
Calculating validation loss: 60.00% done
Time: 165.37 s
Calculating validation loss: 80.00% done
Time: 220.20 s

Validation loss: 49.20399189331968

Time taken: 275.40 s
Saving model to data/tamil/models/awe/7/initial_model_lr_0.0001_tmp_0.15_acc_1000_bs_5_3_9/2024-08-08_12:07:12_checkpoint_epoch_2.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 116.
Regenerated paired data
Epoch 3: 0.00% done
Loss: 2.0403508841991425
Time: 0.07 s
Epoch 3: 10.00% done
Loss: 3.1288549356058417
Time: 396.25 s
Epoch 3: 20.00% done
Loss: 3.0988009167183352
Time: 787.81 s
Epoch 3: 30.00% done
Loss: 3.002738536328859
Time: 1177.23 s
Epoch 3: 40.00% done
Loss: 3.0432488339696704
Time: 1572.08 s
Epoch 3: 50.00% done
Loss: 2.9672492157658756
Time: 1959.00 s
Epoch 3: 60.00% done
Loss: 2.972539071996093
Time: 2370.04 s
Epoch 3: 70.00% done
Loss: 2.920251914426643
Time: 2768.70 s
Epoch 3: 80.00% done
Loss: 2.861942868967732
Time: 3164.87 s
Epoch 3: 90.00% done
Loss: 2.8720435409022405
Time: 3546.74 s

Epoch 3 done
Epoch loss: 2.969688307496215

Time taken for epoch: 3927.21 s
Number of gradients clipped: 0

Calculating validation loss: 0.00% done
Time: 0.26 s
Calculating validation loss: 20.00% done
Time: 51.54 s
Calculating validation loss: 40.00% done
Time: 103.15 s
Calculating validation loss: 60.00% done
Time: 161.21 s
Calculating validation loss: 80.00% done
Time: 212.33 s

Validation loss: 44.23535211349772

Time taken: 264.06 s
Saving model to data/tamil/models/awe/7/initial_model_lr_0.0001_tmp_0.15_acc_1000_bs_5_3_9/2024-08-08_12:07:12_checkpoint_epoch_3.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 102.
Regenerated paired data
Epoch 4: 0.00% done
Loss: 1.8846674263477325
Time: 0.70 s
Epoch 4: 10.00% done
Loss: 2.7546705554396014
Time: 400.07 s
Epoch 4: 20.00% done
Loss: 2.7336615645442777
Time: 797.42 s
Epoch 4: 30.00% done
Loss: 2.697944422566805
Time: 1229.41 s
Epoch 4: 40.00% done
Loss: 2.6955035038635997
Time: 1648.82 s
Epoch 4: 50.00% done
Loss: 2.6483258462122876
Time: 2052.49 s
Epoch 4: 60.00% done
Loss: 2.6314891305843098
Time: 2449.77 s
Epoch 4: 70.00% done
Loss: 2.6628731490429556
Time: 2860.11 s
Epoch 4: 80.00% done
Loss: 2.6057898521136473
Time: 3252.61 s
Epoch 4: 90.00% done
Loss: 2.5842385578721436
Time: 3670.54 s

Epoch 4 done
Epoch loss: 2.6554300927739654

Time taken for epoch: 4087.61 s
Number of gradients clipped: 2

Calculating validation loss: 0.00% done
Time: 0.03 s
Calculating validation loss: 20.00% done
Time: 52.91 s
Calculating validation loss: 40.00% done
Time: 106.39 s
Calculating validation loss: 60.00% done
Time: 159.72 s
Calculating validation loss: 80.00% done
Time: 213.64 s

Validation loss: 40.460700858401566

Time taken: 267.27 s
Saving model to data/tamil/models/awe/7/initial_model_lr_0.0001_tmp_0.15_acc_1000_bs_5_3_9/2024-08-08_12:07:12_checkpoint_epoch_4.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 127.
Regenerated paired data
Epoch 5: 0.00% done
Loss: 3.490738272666931
Time: 0.06 s
Epoch 5: 10.00% done
Loss: 2.6187347064594726
Time: 378.54 s
Epoch 5: 20.00% done
Loss: 2.5893955297970757
Time: 759.56 s
Epoch 5: 30.00% done
Loss: 2.580546330103894
Time: 1136.27 s
Epoch 5: 40.00% done
Loss: 2.552898684544272
Time: 1512.60 s
Epoch 5: 50.00% done
Loss: 2.5491919150976927
Time: 1886.06 s
Epoch 5: 60.00% done
Loss: 2.521654809930584
Time: 2264.24 s
Epoch 5: 70.00% done
Loss: 2.5678898672472634
Time: 2645.04 s
Epoch 5: 80.00% done
Loss: 2.5061779111045617
Time: 3020.44 s
Epoch 5: 90.00% done
Loss: 2.481792861783357
Time: 3394.98 s

Epoch 5 done
Epoch loss: 2.5431032593259117

Time taken for epoch: 3769.43 s
Number of gradients clipped: 1

Calculating validation loss: 0.00% done
Time: 0.21 s
Calculating validation loss: 20.00% done
Time: 52.58 s
Calculating validation loss: 40.00% done
Time: 105.52 s
Calculating validation loss: 60.00% done
Time: 158.12 s
Calculating validation loss: 80.00% done
Time: 210.07 s

Validation loss: 36.45041201769087

Time taken: 262.77 s
Saving model to data/tamil/models/awe/7/initial_model_lr_0.0001_tmp_0.15_acc_1000_bs_5_3_9/2024-08-08_12:07:12_checkpoint_epoch_5.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 116.
Regenerated paired data
Epoch 6: 0.00% done
Loss: 1.8253658711910248
Time: 0.10 s
Epoch 6: 10.00% done
Loss: 2.4133370315379215
Time: 404.97 s
Epoch 6: 20.00% done
Loss: 2.416247356856358
Time: 810.48 s
Epoch 6: 30.00% done
Loss: 2.3898719137075486
Time: 1215.75 s
Epoch 6: 40.00% done
Loss: 2.396645633709347
Time: 1625.68 s
Epoch 6: 50.00% done
Loss: 2.39916736794554
Time: 2034.18 s
Epoch 6: 60.00% done
Loss: 2.3828527876542807
Time: 2435.69 s
Epoch 6: 70.00% done
Loss: 2.359474616647311
Time: 2840.98 s
Epoch 6: 80.00% done
Loss: 2.372167312074531
Time: 3246.38 s
Epoch 6: 90.00% done
Loss: 2.3533565263682688
Time: 3650.99 s

Epoch 6 done
Epoch loss: 2.3836402033451396

Time taken for epoch: 4052.50 s
Number of gradients clipped: 0

Calculating validation loss: 0.00% done
Time: 0.14 s
Calculating validation loss: 20.00% done
Time: 54.85 s
Calculating validation loss: 40.00% done
Time: 107.94 s
Calculating validation loss: 60.00% done
Time: 162.07 s
Calculating validation loss: 80.00% done
Time: 216.83 s

Validation loss: 35.24839610546715

Time taken: 272.69 s
Saving model to data/tamil/models/awe/7/initial_model_lr_0.0001_tmp_0.15_acc_1000_bs_5_3_9/2024-08-08_12:07:12_checkpoint_epoch_6.pt

Dataset generation time limit reached: 240 s.
Number of classes remaining: 124.
Regenerated paired data
Epoch 7: 0.00% done
Loss: 1.7379483580589294
Time: 0.06 s
Epoch 7: 10.00% done
Loss: 2.367339429897907
Time: 378.33 s
Epoch 7: 20.00% done
Loss: 2.3684756612649913
Time: 756.25 s
Epoch 7: 30.00% done
Loss: 2.3372262914052033
Time: 1141.63 s
Epoch 7: 40.00% done
Loss: 2.361979020471605
Time: 1523.11 s
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** JOB 5872163 ON r2i6n7 CANCELLED AT 2024-08-08T21:27:59 ***
slurmstepd: error: *** STEP 5872163.0 ON r2i6n7 CANCELLED AT 2024-08-08T21:27:59 ***
